# ============================================================
# requirements.txt (based on what worked in your environment)
# ============================================================

# -----------------------------
# Core torch stack
# -----------------------------
# You are currently on torch 2.2.2 (+cu121 in your env). Keep torch/torchaudio
# pinned to the SAME version to avoid Transformers / AudioCraft breakage.
#
# If you need a specific CUDA build (e.g., cu121), install torch/torchaudio from
# the official PyTorch index URL for your platform, then install the rest:
#   pip install -r requirements.txt
torch==2.2.2
torchaudio==2.2.2
# torchvision==0.17.2  # optional

# -----------------------------
# Transformers / HF stack
# -----------------------------
# This pin avoids the torch.utils._pytree incompatibility you hit earlier.
transformers==4.41.2
huggingface_hub>=0.23.0
safetensors>=0.4.0
sentencepiece

# -----------------------------
# MusicGen / AudioCraft
# -----------------------------
# AudioCraft is installed from source (this is what you used successfully).
git+https://github.com/facebookresearch/audiocraft.git

# Common AudioCraft / audio deps used by your pipeline
einops
omegaconf
soundfile
numpy>=1.26,<2.0
scipy>=1.10
psutil

# -----------------------------
# Voice engines
# -----------------------------
# MeloTTS (correct package; provides: from melo.api import TTS)
# Do NOT install the unrelated PyPI package named "melo".
git+https://github.com/myshell-ai/MeloTTS.git

# MeloTTS dictionary (you still need to run: python -m unidic download)
unidic

# Coqui TTS (adds a large local model catalog for dropdowns)
TTS>=0.22

# -----------------------------
# Audio utilities
# -----------------------------
pydub==0.25.1

# -----------------------------
# Web app
# -----------------------------
Flask>=3.0

# -----------------------------
# Compatibility / future-proofing
# -----------------------------
# You saw a warning: librosa -> pkg_resources deprecation.
# Keeping setuptools below 81 avoids sudden breakage in some stacks until they update.
setuptools<81

# -----------------------------
# External (NOT Python deps)
# -----------------------------
# - ffmpeg: required by pydub for many audio formats (install via OS package manager)
# - Piper: installed as a CLI binary; not a pip requirement
#   Your app detects it via PATH or PIPER_BIN and scans voices via PIPER_VOICES_DIR.
