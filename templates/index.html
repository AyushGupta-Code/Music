<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Emotion-to-Music Storyteller</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
    />
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />
  </head>
  <body>
    <main class="page">
      <section class="header">
        <div>
          <p class="eyebrow">Web Demo</p>
          <h1>Emotion-to-Music Storyteller</h1>
          <p class="lede">
            Paste a paragraph and get a narrated, emotion-aware soundtrack. The
            background track is generated with MusicGen and the narration comes
            from OpenVoice / Melo-TTS.
          </p>
        </div>
      </section>

      <section class="card">
        <form id="generator-form" class="form">
          <label class="field">
            <span>Paragraph</span>
            <textarea
              name="paragraph"
              id="paragraph"
              rows="6"
              required
            >{{ default_text }}</textarea>
          </label>

          <div class="grid">
            <label class="field">
              <span>Duration (seconds)</span>
              <input type="number" name="duration" id="duration" value="10" min="4" max="40" />
            </label>
            <label class="field">
              <span>Voice language</span>
              <input type="text" name="voice_language" id="voice_language" value="EN" />
            </label>
            <label class="field">
              <span>Voice speed</span>
              <input type="number" step="0.1" name="voice_speed" id="voice_speed" value="1.0" />
            </label>
            <label class="field checkbox">
              <input type="hidden" name="expressive" value="off" />
              <input type="checkbox" name="expressive" id="expressive" checked />
              <span>Expressive narration (pauses + variation)</span>
            </label>
            <label class="field">
              <span>Voice ratio</span>
              <input type="number" step="0.05" name="voice_ratio" id="voice_ratio" value="0.8" min="0.05" max="1" />
            </label>
            <label class="field">
              <span>Music ratio</span>
              <input type="number" step="0.05" name="music_ratio" id="music_ratio" value="0.2" min="0" max="1" />
            </label>
            <label class="field">
              <span>Seed (optional)</span>
              <input type="number" name="seed" id="seed" placeholder="random" />
            </label>
            <label class="field">
              <span>Pause between sentences (ms)</span>
              <input type="number" name="voice_pause_ms" id="voice_pause_ms" value="240" min="0" max="1500" />
            </label>
            <label class="field">
              <span>Speed variation (0-0.3 recommended)</span>
              <input type="number" step="0.01" name="voice_speed_variation" id="voice_speed_variation" value="0.12" min="0" max="0.6" />
            </label>
            <label class="field">
              <span>Energy variation (0-0.3 recommended)</span>
              <input type="number" step="0.01" name="voice_energy_variation" id="voice_energy_variation" value="0.06" min="0" max="0.6" />
            </label>
          </div>

          <button type="submit" id="submit-btn">Generate Audio</button>
        </form>

        <div id="progress" class="progress hidden">
          <div class="progress-label">Generating audioâ€¦</div>
          <div class="progress-track">
            <div class="progress-fill"></div>
          </div>
          <p class="progress-hint">
            Music and narration can take a minute to render. Leave this tab open
            until the download finishes.
          </p>
        </div>

        <div id="result" class="result hidden">
          <div class="result-row">
            <p class="eyebrow">Your mix</p>
            <button type="button" id="reset-btn" class="ghost">Generate again</button>
          </div>
          <audio id="audio-player" controls></audio>
        </div>
      </section>
    </main>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
  </body>
</html>
